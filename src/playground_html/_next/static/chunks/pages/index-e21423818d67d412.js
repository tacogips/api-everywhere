(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5301:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(4090)}])},4090:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return E}});var n=r(8520),s=r.n(n),a=r(5893),o=r(7294),l=r(9669),i=r.n(l),c=r(1163);function u(e,t,r,n,s,a,o){try{var l=e[a](o),i=l.value}catch(c){return void r(c)}l.done?t(i):Promise.resolve(i).then(n,s)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(n,s){var a=e.apply(t,r);function o(e){u(a,n,s,o,l,"next",e)}function l(e){u(a,n,s,o,l,"throw",e)}o(void 0)}))}}var p="",h=function(e){var t=e.fetchData,r=e.searching,n=(0,c.useRouter)(),l=(0,o.useState)(""),u=l[0],h=l[1],f=(0,o.useState)(""),x=f[0],m=f[1],b=(0,o.useState)(""),g=b[0],y=b[1],w=(0,o.useState)(""),v=w[0],j=w[1],_=(0,o.useState)(""),N=_[0],C=_[1];return(0,o.useEffect)((function(){var e=n.query.sheetUrl;e&&h(decodeURIComponent(e))}),[n]),(0,o.useEffect)((function(){function e(){return(e=d(s().mark((function e(){var t,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={url:"".concat(p,"/meta"),method:"get"},e.next=3,i().request(t).catch((function(e){if(e.response){if(404==e.response.status)return null;if(200!=e.response.status)return null}return null}));case 3:(r=e.sent)&&C(r.data.service_account);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"w-full ",children:(0,a.jsxs)("form",{className:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"spread_sheet_url",children:["spread sheet url",(0,a.jsx)("br",{})," (published or share with `",N,"`)"]}),(0,a.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"spread_sheet_url",type:"text",placeholder:"ex. https://docs.google.com/spreadsheets/d/your_spread_sheet_id/edit#gid=0",value:u,onChange:function(e){h(e.target.value)}})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("label",{className:"block text-gray-700 text-sm font-bold py-3",htmlFor:"offset",children:"offset(option)"}),(0,a.jsx)("input",{className:"w-24 shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"offset",type:"text",placeholder:"0",value:x,onChange:function(e){m(e.target.value)}}),(0,a.jsx)("label",{className:"block text-gray-700 text-sm font-bold pl-3 py-3",htmlFor:"limit",children:"limit(option)"}),(0,a.jsx)("input",{className:"w-24 shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"limit",type:"text",placeholder:"100",value:g,onChange:function(e){y(e.target.value)}}),(0,a.jsx)("label",{className:"block text-gray-700 text-sm font-bold pl-3 py-3",htmlFor:"row",children:"row(option)"}),(0,a.jsx)("input",{className:"w-24 shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"row",type:"text",placeholder:"100",value:v,onChange:function(e){j(e.target.value)}})]}),(0,a.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 my-5 px-4 py-2 rounded relative",role:"alert",children:[(0,a.jsx)("strong",{className:"font-bold",children:"Spread sheet MUST NOT Contains sensitive datas."}),(0,a.jsxs)("span",{className:"block inline",children:["This tool and API are published with"," ",(0,a.jsx)("span",{className:"underline",children:(0,a.jsx)("a",{href:"http://github.com/tacogips/api-everywhere/LISENCE",children:"MIT Licence"})}),", so use it at your own risk."]})]}),r?(0,a.jsx)("span",{className:"bg-blue-200 text-white font-bold py-2 px-3 rounded",children:"Seaching. Please wait."}):(0,a.jsx)("span",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-3 rounded",onClick:function(){return t(u,{offset:x,limit:g,row:v})},children:"Fetch Data"})]})})})},f=r(2962);var x=function(e){e=null!==e?e:function(e){throw e}(new TypeError("Cannot destructure undefined"));return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(f.PB,{title:"API Everywhere",description:"Turn google spread sheet to json api",openGraph:{title:"API Everywhere",description:"Turn google spread sheet to json api",site_name:"API Everywhere"},twitter:{cardType:"summary"}})})},m=r(7792),b=function(){return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("nav",{className:"flex items-center justify-between flex-wrap bg-teal-500 ",children:[(0,a.jsx)("div",{className:"flex items-center flex-shrink-0 text-white mr-6 p-6",children:(0,a.jsx)("h1",{className:"font-semibold text-xl tracking-tight",children:"API Everywhere"})}),(0,a.jsx)("div",{children:(0,a.jsx)(m.Z,{href:"https://github.com/tacogips/api-everywhere"})})]})})};var g=function(e){e=null!==e?e:function(e){throw e}(new TypeError("Cannot destructure undefined"));return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)("p",{className:"text-center text-gray-500 text-xs"})})})},y=r(7262),w=r.n(y),v=(r(3804),r(4855)),j=function(e){var t=e.apiURL,r=e.errorMessage,n=e.responseCode,s=e.responseBody;return(0,a.jsxs)(a.Fragment,{children:[r?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{role:"alert",children:[(0,a.jsx)("div",{className:"bg-red-500 text-white font-bold rounded-t px-4 py-2",children:"Error"}),(0,a.jsx)("div",{className:"border border-t-0 border-red-400 rounded-b bg-red-100 px-4 py-3 text-red-700",children:(0,a.jsx)("p",{children:r})})]})}):(0,a.jsx)(a.Fragment,{}),t?(0,a.jsxs)("form",{className:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4",children:[(0,a.jsx)("h2",{className:"mb-3 font-bold",children:"Response"}),(0,a.jsxs)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"api_url",children:["API url",(0,a.jsx)(v.CopyToClipboard,{text:t,children:(0,a.jsx)("span",{className:"bg-white hover:bg-gray-100 text-gray-600 py-1 px-3 border border-gray-400 rounded shadow ml-3",children:"Copy"})})]}),(0,a.jsx)("div",{id:"api_url",className:"mb-3",children:(0,a.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"api_url",type:"text",value:t,readOnly:!0})}),(0,a.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"response_code",children:"response code"}),(0,a.jsx)("div",{id:"response_code",className:"mb-3",children:n||"-"}),(0,a.jsxs)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"response_body",children:["response body",(0,a.jsx)(v.CopyToClipboard,{text:JSON.stringify(s),children:(0,a.jsx)("span",{className:"bg-white hover:bg-gray-100 text-gray-600 py-1 px-3 border border-gray-400 rounded shadow ml-3",children:"Copy"})})]}),(0,a.jsx)("div",{id:"response_body",className:"overflow-auto",style:{maxHeight:"72rem"},children:(0,a.jsx)(w(),{data:s})})]}):(0,a.jsx)(a.Fragment,{})]})};function _(e,t,r,n,s,a,o){try{var l=e[a](o),i=l.value}catch(c){return void r(c)}l.done?t(i):Promise.resolve(i).then(n,s)}function N(e){return function(){var t=this,r=arguments;return new Promise((function(n,s){var a=e.apply(t,r);function o(e){_(a,n,s,o,l,"next",e)}function l(e){_(a,n,s,o,l,"throw",e)}o(void 0)}))}}function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){C(e,t,r[t])}))}return e}var P={url:""},E=function(){var e=(0,o.useState)({apiURL:null,errorMessage:null,responseCode:null,responseBody:null}),t=e[0],r=e[1],n=(0,o.useState)(!1),l=n[0],c=n[1],u=function(e){r({errorMessage:e.toString(),apiURL:null,responseCode:null,responseBody:null})},d=N(s().mark((function e(t){var n,a,o,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&""!==t.trim()){e.next=2;break}return e.abrupt("return",null);case 2:return r({apiURL:null,errorMessage:null,responseCode:null,responseBody:null}),n=encodeURIComponent(t),a={sheet_url:n},o={url:"".concat(P.url,"/sheet_meta"),method:"get",params:a},e.next=8,i().request(o).catch((function(e){return e.response&&(404==e.response.status?u("api server not found "):200!=e.response.status&&u("sheet url is invalid")),null}));case 8:if(!(l=e.sent)){e.next=13;break}return e.abrupt("return",l.data);case 13:return e.abrupt("return",null);case 14:case"end":return e.stop()}}),e)}))),p=function(e){var t=parseInt(e);return NaN!=t&&t>=0},f=N(s().mark((function e(t,n){var a,o,l,c,u,d,h;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data,o={},null!=a.sheet_id_or_name.tab_sheet_name&&(o.sheet_name=a.sheet_id_or_name.tab_sheet_name),null!=a.sheet_id_or_name.tab_sheet_id&&(o.sheet_id=a.sheet_id_or_name.tab_sheet_id),p(n.offset)&&(o.offset=parseInt(n.offset)),p(n.limit)&&(o.limit=parseInt(n.limit)),p(n.row)&&(o.row=parseInt(n.row)),l={url:"".concat(P.url,"/sheet/").concat(a.spread_sheet_id),method:"get",params:o},c=new URLSearchParams(o),u="".concat(P.url,"/sheet/").concat(a.spread_sheet_id,"?").concat(c),P.url.startsWith("http")||window&&(d=[location.protocol,"//",location.host].join(""),u="".concat(d,"/sheet/").concat(a.spread_sheet_id,"?").concat(c)),e.next=13,i().request(l).catch((function(e){return e.response&&(404==e.response.status||200!=e.response.status)&&r({errorMessage:null,apiURL:u,responseCode:e.response.status,responseBody:e.response.data}),null}));case 13:return(h=e.sent)&&r({errorMessage:null,apiURL:u,responseCode:h.status,responseBody:h.data}),e.abrupt("return",h);case 16:case"end":return e.stop()}}),e)}))),m=N(s().mark((function e(t,r){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.next=3,d(t);case 3:if(n=e.sent){e.next=7;break}return c(!1),e.abrupt("return");case 7:return e.next=9,f(n,r);case 9:c(!1);case 10:case"end":return e.stop()}}),e)})));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x,{}),(0,a.jsx)(b,{}),(0,a.jsx)(h,{fetchData:m,searching:l}),(0,a.jsx)(j,k({},t)),(0,a.jsx)(g,{})]})}}},function(e){e.O(0,[966,774,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);